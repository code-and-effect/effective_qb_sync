%h2.effective-qb-sync-page-title= @page_title

%table.table
  %tbody
    - @qb_ticket.attributes.except('hpc_response', 'qb_request_id', 'id').each do |key, value|
      %tr
        %th= key.titleize
        %td= value

%h3 Orders

= simple_form_for @qb_order_items_form, (EffectiveOrders.admin_simple_form_options || {}).merge(url: effective_qb_sync.admin_qb_sync_path(@qb_order_items_form)) do |f|
  %table.table
    %thead
      %tr
        %th Order
        %th Order Item
        %th Quickbooks Item Name
    %tbody
      - @qb_ticket.orders.each do |order|
        - order.order_items.each_with_index do |order_item, index|
          %tr
            %td= (link_to(('#' + order.to_param.to_s), effective_orders.admin_order_path(order)) if index == 0)
            %td= order_item
            %td
              = f.simple_fields_for :qb_order_items, order_item.qb_order_item do |foi|
                = foi.input :order_item_id, as: :hidden, value: order_item.id
                = foi.input :name, label: false, required: false

  %p= f.button :submit, 'Save Quickbooks Item Names', data: { disable_with: 'Saving...' }



%h3 Sync Log

%table.table
  %thead
    %tr
      %th Time
      %th Message
  %tbody
    - @qb_ticket.qb_logs.each do |qb_log|
      %tr
        %th= qb_log.created_at.strftime("%H:%M:%S").html_safe
        %td= qb_log.message







